<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="goods">
	
	<insert id="register" parameterType="hashMap">
		INSERT INTO t_goods(goods_nm, goods_post, goods_address, goods_detail_address, goods_tel, goods_view_yn, t_goods_type_seq, t_company_seq)
		VALUES(#{goods_nm}, #{goods_post}, #{goods_address}, #{goods_detail_address}, #{goods_tel}, 'N', #{t_goods_type_seq}, #{company_seq})
	</insert>
	
	<insert id="detail_register" parameterType="hashMap">
		INSERT INTO t_goods_detail(goods_detail_nm, goods_detail_price, goods_detail_amount, goods_detail_view_yn, goods_detail_expression, t_goods_seq, t_promotion_seq)
		VALUES(#{goods_detail_nm}, #{goods_detail_price}, #{goods_detail_amount}, 'N', #{goods_detail_expression}, #{goods_seq}, #{t_promotion_seq})
	</insert>
	
	<select id="select_goods" parameterType="hashMap" resultType="goods">
		SELECT *, type_nm
		FROM 
			t_goods a, t_goods_type b
		WHERE
			a.goods_seq = #{goods_seq}
		AND	
			a.t_goods_type_seq = b.type_seq
		
	</select>
	
	<select id="detail_goods" parameterType="hashMap" resultType="goodsDetail" >
		SELECT a.*, b.promotion_nm
		FROM
			t_goods_detail a, t_promotion b
		WHERE
			a.goods_detail_seq = #{goods_detail_seq}
		AND
			a.t_goods_seq = #{goods_seq}
		AND
			a.t_promotion_seq = b.promotion_seq
	</select>
	
	<select id="select_cgoodsList" parameterType="hashMap" resultType="goods">
		SELECT *
		FROM
			t_goods a, t_goods_type b, t_company c
		WHERE
			a.t_goods_type_seq = b.type_seq
		AND	
			a.t_company_seq = #{company_seq}
		AND	
			a.t_company_seq = c.company_seq
	</select>
	
	<select id="select_sgoodsList" parameterType="hashMap" resultType="goods">
		SELECT *
		FROM
			t_goods a, t_goods_type b, t_company c
		WHERE
			a.t_goods_type_seq = b.type_seq
		AND	
			a.t_company_seq = #{t_company_seq}
		AND	
			a.t_company_seq = c.company_seq
		AND
			a.goods_nm LIKE CONCAT('%',#{goods_nm},'%')
	</select>
	
	<select id="select_goodsList" resultType="goods">
		SELECT *
		FROM
			t_goods a, t_goods_type b
		WHERE
			a.t_goods_type_seq = b.type_seq
		ORDER BY a.goods_seq
	
	</select>
	<select id="two_goodsList" parameterType="hashMap" resultType="goods">
		SELECT *
		FROM
			t_goods a, t_goods_type b, t_company c
		WHERE
			a.t_goods_type_seq = b.type_seq
		AND	
			a.t_company_seq = c.company_seq
		AND	
			c.company_nm LIKE CONCAT('%',#{company_nm},'%')
		AND
			a.goods_nm LIKE CONCAT('%',#{goods_nm},'%')
	</select>
	
	<select id="gn_goodsList" parameterType="hashMap" resultType="goods">
		SELECT *
		FROM
			t_goods a, t_goods_type b, t_company c
		WHERE
			a.t_goods_type_seq = b.type_seq
		AND	
			a.t_company_seq = c.company_seq
		AND
			a.goods_nm LIKE CONCAT('%',#{goods_nm},'%')
	</select>
	
	<select id="cn_goodsList" parameterType="hashMap" resultType="goods">
		SELECT *
		FROM
			t_goods a, t_goods_type b, t_company c
		WHERE
			a.t_goods_type_seq = b.type_seq
		AND	
			a.t_company_seq = c.company_seq
		AND	
			c.company_nm LIKE CONCAT('%',#{company_nm},'%')
	</select>
	
	<select id="select_detail_goodsList" parameterType="int" resultType="goodsDetail">
		SELECT *
		FROM
			t_goods_detail
		WHERE
			t_goods_seq = #{goods_seq}
	</select>
	
	<update id="isViewY" parameterType="hashMap">
		UPDATE
			t_goods
		SET
			goods_view_yn = 'Y'
		WHERE
			goods_seq = #{goods_seq}
	</update>
	
	<update id="detail_isViewY" parameterType="hashMap">
		UPDATE
			t_goods_detail
		SET
			goods_detail_view_yn = 'Y'
		WHERE
			t_goods_seq = #{goods_seq}
		AND
			goods_detail_seq = #{goods_detail_seq} 
	</update>
	
	<update id="isViewN" parameterType="hashMap">
		UPDATE
			t_goods
		SET
			goods_view_yn = 'N'
		WHERE
			goods_seq = #{goods_seq}
	</update>
	
	<update id="detail_isViewN" parameterType="hashMap">
		UPDATE
			t_goods_detail
		SET
			goods_detail_view_yn = 'N'
		WHERE
			t_goods_seq = #{goods_seq}
		AND
			goods_detail_seq = #{goods_detail_seq} 
	</update>
	
	<update id="update" parameterType="hashMap">
		UPDATE 
			t_goods
		SET
			goods_nm=#{goods_nm}, goods_post=#{goods_post}, goods_address=#{goods_address}, goods_detail_address=#{goods_detail_address}, goods_tel=#{goods_tel} 
		WHERE
			goods_seq=#{goods_seq}	
	</update>
	
	<update id="detail_update" parameterType="hashMap">
		UPDATE 
			t_goods_detail
		SET
			goods_detail_nm=#{goods_detail_nm}, goods_detail_price=#{goods_detail_price}, goods_detail_amount=#{goods_detail_amount}, goods_detail_expression=#{goods_detail_expression} 
		WHERE
			goods_detail_seq=#{goods_detail_seq}	
	</update>
	
	<delete id="delete_first" parameterType="string">
		DELETE
		FROM
			t_goods_detail
		WHERE 
			t_goods_seq = #{goods_seq}
		
	</delete>
	
	<delete id="delete_second" parameterType="string">
		DELETE
		FROM
			t_goods
		WHERE 
			goods_seq = #{goods_seq}
		
	</delete>
	
	<delete id="detail_delete" parameterType="hashMap">
		DELETE
		FROM
			t_goods_detail
		WHERE
			goods_detail_seq = #{goods_detail_seq}
		AND
			t_goods_seq = #{goods_seq}	
	</delete>
</mapper>
 